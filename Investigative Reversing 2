from pwn import unbits

# open the image in "read binary" mode
with open("encoded.bmp", "rb") as data:
    data.seek(2000)
    bin_str = ""
    # The flag is 50 chars, each using 8 bits (8 bytes of image data)
    for j in range(50 * 8):
        # Read one byte from the encoded image
        byte = data.read(1)[0]

        # The bitwise AND (& 1) isolates the LSB, which is the hidden flag bit
        bit = byte & 1
        bin_str += str(bit)

# unbits reverses the bit-shifting logic.
# 'little' endian is used because the encoding function stored the LSB of the char first.
char_str = unbits(bin_str, endian='little')

# The final step reverses the character offset: Flag = (Decoded Byte) + 5
flag = "".join([chr(x + 5) for x in char_str])

print("Flag: " + flag)



                                                                                                                                                                                                                                                                                                  
┌──(kali㉿lto)-[~/Downloads/picoctf]
└─$ wget https://jupiter.challenges.picoctf.org/static/8d9a6d8feccbe449f4c41d6fe965f7a9/mystery    
--2025-11-09 13:59:05--  https://jupiter.challenges.picoctf.org/static/8d9a6d8feccbe449f4c41d6fe965f7a9/mystery
Resolving jupiter.challenges.picoctf.org (jupiter.challenges.picoctf.org)... 3.131.60.8
Connecting to jupiter.challenges.picoctf.org (jupiter.challenges.picoctf.org)|3.131.60.8|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 16784 (16K) [application/octet-stream]
Saving to: ‘mystery’

mystery                                                                  100%[================================================================================================================================================================================>]  16.39K  --.-KB/s    in 0s      

2025-11-09 13:59:06 (331 MB/s) - ‘mystery’ saved [16784/16784]

                                                                                                                                                                                                                                                                                                  
┌──(kali㉿lto)-[~/Downloads/picoctf]
└─$ wget https://jupiter.challenges.picoctf.org/static/8d9a6d8feccbe449f4c41d6fe965f7a9/encoded.bmp
--2025-11-09 13:59:13--  https://jupiter.challenges.picoctf.org/static/8d9a6d8feccbe449f4c41d6fe965f7a9/encoded.bmp
Resolving jupiter.challenges.picoctf.org (jupiter.challenges.picoctf.org)... 3.131.60.8
Connecting to jupiter.challenges.picoctf.org (jupiter.challenges.picoctf.org)|3.131.60.8|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1507414 (1.4M) [application/octet-stream]
Saving to: ‘encoded.bmp’

encoded.bmp                                                              100%[================================================================================================================================================================================>]   1.44M  1.19MB/s    in 1.2s    

2025-11-09 13:59:15 (1.19 MB/s) - ‘encoded.bmp’ saved [1507414/1507414]

                                                                                                                                                                                                                                                                                                  
┌──(kali㉿lto)-[~/Downloads/picoctf]
└─$ ls             
encoded.bmp  mystery  RSACTFTOOL  venv
                                                                                                                                                                                                                                                                                                  
┌──(kali㉿lto)-[~/Downloads/picoctf]
└─$ cat mystery      
ELF>�@P:@8
          @@@@h�������   ((�-�=�=���-�=�=����DDP�td� � � DDQ�tdR�td�-�=�=xx/lib64/ld-linux-x86-64.so.2GNUGNU-!U���=瀟6�cF�n����
                                                                                                                               �
                                                                                                                                �e�mv 92N� 
                                                                                                                                           � ?"libc.so.6exitfopenputs__stack_chk_failfputcfclosefread__cxa_finalize__libc_start_mainGLIBC_2.4GLIBC_2.2.5_ITM_deregisterTMCloneTable__gmon_start___`u▒iregij��@�?�?��?Tableii
                   �?
                     �?�?�?�?�?�?       �?
SH�=�/H��t��H���5j/�%l/@�%j/h������%b/h������%Z/h������%R/h������%J/h������%B/h������%:/h������%R/f�1�I��^H��H���PTL��H�
    �/�DH�=)/H�"/H9�tH��.H��t   �����H�=�.H�5�.H)�H��H��H��?H�H��tH��.H����fD���=�.u/UH�=�.H��t
�2���H�E�H�}�u                                                                                 H�=�.�-����h�����.]�����{���UH���}����E��ЈE��E��E���}�t�U��E������ЈE��E� E��E� E��EE��E�]�UH��H�����|���H��p���dH�%(H�E�1��E�H�5�
�����H�}�u    H�=�
������k����E��l�E��Y�E��ЋE�H��D����ȋE��Ή��;����E��E�H�U�H�։�����H�U�H�E�H�Ѻ�H��������E��}�~��E��}�1~��5�E���H�U�H�։������H�U�H�E�H�Ѻ�H���l����E��}�t�H�E�H���g���H�E�H���[���H�E�H���O����H�M�dH3
                                                                                                                                                                                                 %(t�F�����@AWI��AVI��AUA��ATL�%P)UH�-P)SL)�H������H��t�L��L��D��A��H��H9�u�H�[]A\A]A^A_��H�H��rflag.txtoriginal.bmpaencoded.bmpNo flag found, please make sure this is run on the serveroriginal.bmp is missing, please run this on the serverflag is not 50 chars@d�������������\�����#����d���
                                                                                                                                                                                               ����TzRx
                                                                                                                                                                                                      ����+zRx
                                                                                                                                                                                                             $�����F▒J
E                                                                                                                                                                                                                     �?▒;*3$"D(��\���JA�C
8/���=A�C
D�P���]B�E▒�E �E(�H0�H8�G@j8A0A(B B▒B�h����P
��▒����h0
�
 ▒�?�0� ������o@���o���o$���o�=6FVfv�@GCC: (Ubuntu 8.2.0-7ubuntu1) 8.2.0��0h@   p
0

��� � !�=�=�=�?@▒@��
                    �!P7▒@F�=m�y�=������$"����=��=��=�� ��?
                                                          ��J � @8J]@d
                                                                      �x���@� @� � ]�▒▒@��+▒@▒�=2D@P j"crtstuff.cderegister_tm_clones__do_global_dtors_auxcompleted.7930__do_global_dtors_aux_fini_array_entryframe_dummy__frame_dummy_init_array_entrymys.c__FRAME_END____init_array_end_DYNAMIC__init_array_start__GNU_EH_FRAME_HDR_GLOBAL_OFFSET_TABLE___libc_csu_finicodedChar_ITM_deregisterTMCloneTableputs@@GLIBC_2.2.5fread@@GLIBC_2.2.5_edatafclose@@GLIBC_2.2.5__stack_chk_fail@@GLIBC_2.4fputc@@GLIBC_2.2.5__libc_start_main@@GLIBC_2.2.5__data_start__gmon_start____dso_handle_IO_stdin_used__libc_csu_init__bss_startmainfopen@@GLIBC_2.2.5exit@@GLIBC_2.2.5__TMC_END___ITM_registerTMCloneTable__cxa_finalize@@GLIBC_2.2.5.symtab.strtab.shstrtab.interp.note.ABI-tag.note.gnu.build-id.gnu.hash.dynsym.dynstr.gnu.version.gnu.version_r.rela.dyn.rela.plt.init.plt.got.text.fini.rodata.eh_frame_hdr.eh_frame.init_array.fini_array.dynamic.data.bss.comment�#�� 1��$D��No
                                                                                  00▒Vhh�^���o$$▒k���o@@zpp▒�B00▒��  ��������   �  �� � D�!!������=�-��?��@@�00#80▒     �6�N9�                                                                                                                                                                                                                                                                                                  
┌──(kali㉿lto)-[~/Downloads/picoctf]
└─$ nano solve.py
                                                                                                                                                                                                                                                                                                  
┌──(kali㉿lto)-[~/Downloads/picoctf]
└─$ chmod +x solve.py 
                                                                                                                                                                                                                                                                                                  
┌──(kali㉿lto)-[~/Downloads/picoctf]
└─$ python3 solve.py
Flag: picoCTF{n3xt_0n300000000000000000000000000394060c}

